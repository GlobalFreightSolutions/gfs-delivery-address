<script src="../webcomponentsjs/webcomponents.min.js"></script>
<link rel="import" href="../polymer/polymer.html" />

<dom-module id="gfs-delivery-address">
	<style>
		div, span, h3 {
			font-family: "Raleway", "Helvetica Neue", Verdana, Arial, sans-serif;
		}
		.infoText {
			margin-top: 0.5em;
			margin-bottom: 0.5em;
		}
		#container {
			padding: 10px;
			/*margin: 10px;*/
			min-height: 120px;
			background-color: #FAFAFA;
			border-radius: 3px;
			box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
			border: 1px solid #FAFAFA;
		}
		h3 {
			margin-top: 0px;
		}
	</style>


	<template>
        <div id="container">  
            <h3>Your delivery address</h3>      
            <div class="info"> 
                <template is="dom-if" if="{{overrideStreetAddress}}">
                    <div class="infoText">Your new delivery address is {{overrideStreetAddress}}</div>
                </template>
                <template is="dom-if" if="{{!overrideStreetAddress}}">
                    <div class="infoText">Your current delivery address is {{defaultStreetAddress}}</div>
                </template>             
                
            </div>
        </div>


    </template>

    <script>

        Polymer({
            is: "gfs-delivery-address",

            properties: {
                defaultStreetAddress: {
                	type: String
                },
                overrideStreetAddress: {
                    type: String,
                    value: null
                }

            },
            listeners: {

            },
            ready: function() {
            	window.addEventListener('droppoint-changed', this.onDroppointChanged.bind(this), false);
            },
            onDroppointChanged: function (e) {
            	this.set("droppointData", e.detail);
            	if (this.droppointData.chosen === true) {
            		this.overrideStreetAddress = this.droppointData.geoLocation.addressLines + ', ' + this.droppointData.geoLocation.town + ', ' + this.droppointData.geoLocation.postCode;
            	}
            	else {
            		this.overrideStreetAddress = this.initialAddress;
            	}
            }
        });
    </script>
</dom-module>